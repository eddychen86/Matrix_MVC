@* Model no longer used; hot list loads via API *@
@using Matrix.Services
@inject ICustomLocalizer Localizer

<!-- 文章 -->
<div class="col-span-5 2xl:col-span-4 2xl:col-start-2 flex flex-col gap-8">

    @* 熱門文章輪播（僅登入可見） *@
    @if (ViewBag.IsAuthenticated == true)
    {
        <section class="home-hots_list overflow-x-hidden">
            <h1 class="title">Hot</h1>
            <div class="hots_list_carousel">
                <button v-on:click="hotPrev">
                    <i data-lucide="chevron-left" class="size-6"></i>
                </button>
                <button v-on:click="hotNext">
                    <i data-lucide="chevron-right" class="size-6"></i>
                </button>

                <ul ref="hotCarouselRef" class="carousel carousel-center carousel_layout" v-if="hotlist && hotlist.length">
                    <li class="carousel-item carousel-item_cts" v-for="item in hotlist" :key="item.articleId">
                        <div class="card bg-base-100 image-full shadow-sm">
                            <figure>
                                <img v-if="item.image && item.image.filePath" :src="item.image.filePath" :alt="item.content" />
                                <div v-else class="no-img bg-accent">
                                    <i data-lucide="image" class="size-12"></i>
                                </div>
                            </figure>
                            <div class="card-body carousel-item_body">
                                <div class="userInfo">
                                    <a href="/profile">
                                        <img v-if="item.authorAvatar" :src="item.authorAvatar" :alt="item.authorName" />
                                        <div v-else class="no-img">
                                            <span>{{ (item.authorName || '').slice(0, 1).toUpperCase() }}</span>
                                        </div>
                                    </a>
                                    <h2 class="card-title text-sm">{{ item.authorName || '' }}</h2>
                                </div>
                                <div class="card-actions justify-end">
                                    <p class="line-clamp-3 text-xs">{{ item.content }}</p>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>

                <div class="no-data" v-else>
                    <i data-lucide="file-text" class="size-12"></i>
                    <p class="subTitle">No data</p>
                </div>
            </div>
        </section>
    }

    
    <!-- 文章列表 -->
    <section class="home-posts_list">

        <div class="post_editor_app">
            <h3 class="title">News</h3>
            <!--發文編輯-->
            @if (ViewBag.IsAuthenticated == true)
            {
                <button v-on:click="toggleCreatePost">
                    <i data-lucide="plus" class="size-6 text-black"></i>
                    <span class="subTitle">Post</span>
                </button>
            }
        </div>

        <ul class="post-content" id="homePostsList">
            @await Component.InvokeAsync("PostList")
        </ul>
    </section>
</div>

<!-- 好友列表 -->
<aside class="friends-list">
    @await Component.InvokeAsync("FriendsList")
</aside>

@* Create Post Popup Component *@
<div v-if="openCreatePost">
    @await Component.InvokeAsync("CreatePostPopup")
</div>

<div v-else-if="openReply">
    @await Component.InvokeAsync("ReplyPopup")
</div>

@* Hot list logic moved to /js/pages/home/home.js (Vue setup) *@
