@* Model no longer used; hot list loads via API *@
@using Matrix.Services
@inject ICustomLocalizer Localizer

<!-- 文章 -->
<div class="col-span-7 flex flex-col gap-8 2xl:col-span-4 2xl:col-start-2">

    @* 熱門文章輪播（僅登入可見） *@
    <section class="home-hots_list overflow-hidden !h-[300px]">
        <h1 class="title">Hot</h1>
        <div class="hots_list_carousel">
            <button v-on:click="hotPrev">
                <i data-lucide="chevron-left" class="size-6"></i>
            </button>
            <button v-on:click="hotNext">
                <i data-lucide="chevron-right" class="size-6"></i>
            </button>

            <ul ref="hotCarouselRef" class="carousel carousel-center carousel-end carousel_layout gap-x-4" v-if="hotlist && hotlist.length">
                <li class="carousel-item carousel-item_cts !max-h-[250px] !max-w-[200px]" v-for="(item, idx) in hotlist" :key="item.articleId">
                    <div class="card image-full shadow-sm w-full">
                        <figure>
                            <img v-if="item.image && item.image.filePath" :src="item.image.filePath" class="!bg-accent" />
                            <div v-else class="no-img bg-accent size-full flex items-center justify-center">
                                <i data-lucide="image" class="size-12"></i>
                            </div>
                        </figure>
                        <div class="card-body carousel-item_body">
                            <div class="card-actions text-white h-[170px] overflow-hidden">
                                <p class="SubTitle !text-start">{{ item.content.length > 100 ? `${item.content.slice(0, 100)}...` : item.content }}</p>
                            </div>
                            <div class="userInfo">
                                <a :href="`/Profile/${item.authorName.replace(/\s+/g, '')}`">
                                    <img v-if="item.authorAvatar" :src="item.authorAvatar" :alt="item.authorName" />
                                    <div v-else class="no-img border-2 border-white bg-secondary">
                                        <span>{{ (item.authorName || '').slice(0, 1).toUpperCase() }}</span>
                                    </div>
                                </a>
                                <a :href="`/Profile/${item.authorName.replace(/\s+/g, '')}`">
                                    <h2 class="card-title text-sm text-white">{{ item.authorName || '' }}</h2>
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="w-96"></li>
            </ul>

            <div class="no-data" v-else>
                <i data-lucide="file-text" class="size-12"></i>
                <p class="subTitle">No data</p>
            </div>
        </div>
    </section>

    
    <!-- 文章列表 -->
    <section class="home-posts_list">

        <div class="post_editor_app">
            <h3 class="title">News</h3>
            <!--發文編輯-->
            @if (ViewBag.IsAuthenticated == true)
            {
                <button v-on:click="openModal">
                    <i data-lucide="plus" class="size-6 text-black"></i>
                    <span class="subTitle">Post</span>
                </button>
            }
        </div>

        <ul class="post-content" id="homePostsList">
            @await Component.InvokeAsync("PostList")
        </ul>
    </section>
</div>

<!-- 好友列表 -->
<!--
    <aside class="friends-list">
        await Component.InvokeAsync("FriendsList")
    </aside>
-->
@if (ViewBag.IsAuthenticated) {
    @* Create Post Popup Component *@
    @await Component.InvokeAsync("CreatePostPopup")

    <!-- 留言視窗 -->
    @await Component.InvokeAsync("ReplyPopup")
}
